# auto-maptive
Automatic xlsx uploads to maptive API

## Build

```bash
./gradlew build
```

## Native image build (Graal)

```bash
native-image \
  --no-fallback \
  -H:+AddAllCharsets \
  --no-server \
  -H:ConfigurationFileDirectories=$(pwd)/auto-maptive-simple-app/src/main/native/config \
  -jar auto-maptive-simple-app/build/libs/auto-maptive-simple-app-*.jar
```

## Run

Create an `application.properties` file in the running dirrectory with the below settings
```properties
# The API key provided by Maptive
key=123456789
# The ID of the map to update in maptive (taken from the URL)
map=123
# The full filepath to the xlsx file which will be watched for updates
file=/path/to/MyFile.xlsx
# How often, in seconds, to check the xlsx file for updates
schedule=5
```

Then run the native image or jar as normal e.g.
```bash
java -jar app.jar
# or
./app
```

## Updating native config

native-image requires several configuration files so that it may correctly build an image.

Rather than determining these manually they can be generated by running the jar application and attaching a specific
agent.

```bash
java \
  -agentlib:native-image-agent=config-output-dir=$(pwd)/auto-maptive-simple-app/src/main/native/config \
  -jar auto-maptive-simple-app/build/libs/auto-maptive-simple-app-*.jar
```

Run the program as normal and ensure that interactions are performed with maptive, then stop the application.